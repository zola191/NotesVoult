# IEnumerable


## Когда что использовать?


✅ **Оба интерфейса поддерживают отложенное выполнение**, но работают принципиально по-разному:

|                                | `IEnumerable`                         | `IQueryable`                                |
| ------------------------------ | ------------------------------------- | ------------------------------------------- |
| **Тип отложенного выполнения** | Ленивая оценка (lazy evaluation)      | Построение выражения (expression trees)     |
| **Когда выполняется**          | При итерации (foreach, ToList и т.д.) | При переводе выражения в запрос (SQL и др.) |
| **Где выполняется**            | В памяти (клиентская сторона)         | На сервере (БД, удалённый источник)         |
|                                |                                       |                                             |

### ✔️ Используйте IEnumerable когда:

1. Работаете с коллекциями в памяти
2. Нужны все методы LINQ (некоторые доступны только для IEnumerable, пример .ElementAt(), .ToDictionary(), .Zip(), .Aggregate() )
3. Данные уже загружены или их мало
    

### ✔️ Используйте IQueryable когда:

1. Работаете с базой данных (Entity Framework)
2. Нужно комбинировать условия динамически
3. Хотите минимизировать передачу данных
4. Работаете с большими объемами данных


```csharp
// IEnumerable - ВСЕ операции выполняются в памяти после загрузки ВСЕХ данных
var result = users
    .Where(u => u.Age > 18)    // 1. Загружаются ВСЕ пользователи из БД
                               // 2. Фильтрация (Age > 18) происходит в памяти
    .OrderBy(u => u.Name)      // 3. Сортировка по имени в памяти
    .Take(10);                 // 4. Берется 10 первых из уже отфильтрованных

// IQueryable - операции преобразуются в SQL и выполняются на сервере
var result = db.Users          // Начинаем с IQueryable (не загружая данные)
    .Where(u => u.Age > 18)    // Преобразуется в WHERE Age > 18 в SQL
    .OrderBy(u => u.Name)      // Преобразуется в ORDER BY Name в SQL
    .Take(10);                 // Преобразуется в TOP 10 / LIMIT 10 в SQL
// На сервер уходит ОПТИМИЗИРОВАННЫЙ запрос
SELECT TOP 10 * FROM Users 
WHERE Age > 18 
ORDER BY Name
```